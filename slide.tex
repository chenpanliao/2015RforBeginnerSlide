%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode

\documentclass[12pt]{beamer}
\usepackage{amsmath, fancyvrb, textcomp}
\usepackage{xcolor}
\definecolor{verb}{rgb}{0.0,0.4,0.0}
\definecolor{white}{rgb}{1,1,1}


%% Beamer 版面配置
\mode<presentation>

\usecolortheme{rose}

\useoutertheme[subsection=false]{miniframes}

    \setbeamercolor{postit}{fg=black,bg=blue!5}    \setbeamertemplate{headline}    {%      \begin{beamercolorbox}[wd=1\paperwidth]{postit}        \vskip1pt\insertnavigation{1\paperwidth}\vskip1pt      \end{beamercolorbox}%    }

    \setbeamertemplate{frametitle}    {%      \vskip-5pt%
      \begin{beamercolorbox}[wd=1\paperwidth,ht=2.3ex,dp=0.8ex,left]{postit}        \hskip0.5cm\insertframetitle\par      \end{beamercolorbox}%
    }
    %\setbeamercolor{frametitle}{fg=black}

%\setbeamertemplate{frametitle}{\vskip-5pt\hskip0cm\insertframetitle\par}
\setbeamersize{text margin left=0.5cm, text margin right=0.5cm}


\let\oldfootnote\footnote
\renewcommand\footnote[1]{\hspace{-0.6em}\oldfootnote{\scriptsize\ignorespaces#1}\hspace{0.6em}}
\setbeamerfont{footnote mark}{size=\tiny}

\usefonttheme{structurebold}


\beamertemplatenavigationsymbolsempty % 去除 Beamer 導覽工具列
\setbeamertemplate{footline}[frame number]{}

%\DefineVerbatimEnvironment{MyVerbatim}{Verbatim}{fontsize=\tiny}

%% 西文字配置
\linespread{1.1}
\usepackage{arevmath}
\usepackage[no-math]{fontspec}
\setmainfont[Mapping=tex-text, LetterSpace=0, BoldFont={Lato Bold}]{Lato}
\setsansfont[Mapping=tex-text, LetterSpace=0, BoldFont={Lato Bold}]{Lato}
\setmonofont[Color=verb, Scale=1]{Osaka-Mono}
%\setmonofont[Color=verb, Scale=0.9, LetterSpace=-0]{PT Mono}
\usefonttheme{professionalfonts}

%% 中文字配置
\usepackage[
  CJKmath=true, indentfirst=false, PunctStyle={quanjiao}, CheckSingle=false
]{xeCJK}
\setCJKmainfont[Scale=1, BoldFont={LiHei Pro}]{Heiti TC Medium}
%\setCJKmonofont[Scale=1, BoldFont={Osaka-Mono}, Color=verb]{Osaka-Mono}
\setCJKmonofont[Scale=1, BoldFont={LiHei Pro}, Color=verb]{Heiti TC Light}

\title[初學者學習R語言]{初學R語言的100分鐘}
\author[廖鎮磐]{廖鎮磐 \\ \texttt{<andrew.43@gmail.com>}\\ 東海大學生命科學系}
\institute{\normalsize 2015年台灣生態研究網年會 \\ \footnotesize 2015年3月14日於蓮華池研究中心}
\date{\scriptsize \includegraphics[width=2cm]{cc.pdf}\\
本文件採用姓名標示-相同方式分享 4.0 國際（CC BY-SA 4.0，詳情請見 \url{http://creativecommons.org/licenses/by-sa/4.0/deed.zh_TW}）。}




\AtBeginSection[] {
  \begin{frame}
    \frametitle{大綱}
    \tableofcontents[currentsection]
  \end{frame}
  \addtocounter{framenumber}{-1}
} 

\begin{document}


\begin{frame}
\titlepage
\end{frame}

\begin{frame}
\frametitle{大綱}
\tableofcontents
\end{frame}

\section{事前準備}\subsection{}


\begin{frame}{請先下載投影片和練習資料}
\begin{center}
\Huge\url{http://goo.gl/YRCOaN}\\
\includegraphics[width=2.5in]{url-dropbox.pdf}
\end{center}
\end{frame}

\begin{frame}{我今天希望讓諸位達成\ldots\ldots}
\begin{itemize}
\item 不怕害使用R這類以文字指令進行的工作方式。
\item 如何自己救自己。
\item 如何請別人救自己。
\item 實作一些常見的統計分析與繪圖。
\end{itemize}
\end{frame}




\begin{frame}{為什麼我選擇R？}
\begin{itemize}
\item 自由、免費、跨平台。
\item 是一種「程式語言」，像Python、Perl、JAVA等。
\item 是一種「統計工具」，像SAS、SPSS等。
\item 強大的視覺化工具，畫專業的圖，但需要經驗。
\item 套件豐富，不同自己重新寫程式。
\end{itemize}
%\begin{block}{怎麼入門？}
%\begin{itemize}
%\item 買（可能不只一本）書。
%\item 網路教學和論壇。
%\end{itemize}
%\end{block}
\end{frame}

\begin{frame}[fragile]{安裝R語言}
\begin{enumerate}
\item 到達 \url{http://www.r-project.org/}
\item 點選Download, Packages (CRAN) \\
\item 選擇作業平台
	\begin{center}\includegraphics[width=0.7\textwidth]{downloadR.png}\end{center}
\end{enumerate}
\end{frame}

\begin{frame}[fragile]{選用適當的R程式編輯器}
\begin{itemize}
\item 建議以純文字編輯器撰寫R程式碼，並儲存成「\verb+.R+」檔。
\item 「語法多色支援」、「語法提示」、「即時執行」等功能，增加撰寫效率。
\item 支援R語言的編輯器很多，有興趣請自行試用。
\begin{description}
	\item [RStudio] 強大、整合性高、專為R程式員設計。\footnote{\url{http://www.rstudio.com/}}
	\item [Notepad++] 老字號的純文字編輯器，有和R相配合的外掛。\footnote{\url{http://notepad-plus-plus.org/}}
	\item [Atom] 與GitHub配合度高。\footnote{\url{https://atom.io/}}
\end{description}
\end{itemize}
\end{frame}


\begin{frame}[fragile]{R的套件}
\begin{block}{什麼是套件（package）？}
安裝在R系統裡的外掛，讓你「不用重新造輪子」。
\end{block}

\begin{block}{如何安裝、更新及引入套件？}
\begin{itemize}
\item 連上網路之後，輸入
\verb+install.packages("套件名稱")+
可以安裝某套件，而
\verb+update.packages()+
可以更新所有已安裝套件。
\item 在已安裝某套件之後，輸入
\verb+library(套件名稱)+
可引入該套件，之後才可以使用它的功能。
\end{itemize}
\end{block}

\begin{block}{練習}
安裝一個名叫「\verb+vegan+」的套件，並將之引入R中。
\end{block}
\end{frame}

\begin{frame}[fragile]{R的官方套件庫}
\url{http://cran.r-project.org/web/packages/available_packages_by_name.html}\\
官方的套件一覽表（目前有六千多個）。可直接以 \verb+install.packages()+ 安裝。
\end{frame}


\begin{frame}[fragile]{初次見面：R是計算機}
\begin{columns}
\column{0.4\textwidth}
\begin{verbatim}
> 2.4 + 42
[1] 44.4
> 4 ^ 2
[1] 16
> sqrt(100)
[1] 10
> 100 ^ 0.5
[1] 10
\end{verbatim}

\column{0.4\textwidth}
\begin{verbatim}
> a <- 1
> a
[1] 1
> 1 -> b
> b
[1] 1
> a + b
[1] 2
\end{verbatim}

\end{columns}
\end{frame}


\begin{frame}[fragile]{Q\&A的時間到囉}
\begin{itemize}
\item[Q] 有什麼方式可以學R學得快一點？
\item[A] 肯看英文、肯多嘗試累積經驗、肯問人。
\end{itemize}
\begin{itemize}
\item[Q] 阿盤學多久才叫「上手」、「有生產力」？
\item[A] 自學半年以上，但我今天就要把八成功力都傳給你了！
\end{itemize}
\begin{itemize}
\item[Q] 如何快速累積經驗？
\item[A] 拿出統計學課本的例題，用R做做看；做過的程式碼要建檔，以後就只要複製貼上。
\end{itemize}
\begin{itemize}
\item[Q] 如何找能做某件事的套件？
\item[A] 請Google大神幫你找最快。真的。
\end{itemize}
\end{frame}

\section{R的函數}\subsection{}

\begin{frame}[fragile]{什麼是程式語言的函數（function）}

\begin{block}{使用某函數的語法通則}
\verb+函數名(第一引數名 = 某值, 第二引數名 = 某值, ...)+ 
\end{block}

\begin{itemize}
\item 操作R的過程，幾乎就是使用各種function的過程。
\item 就像數學裡的函數一樣：把x放到f裡，得到一個f(x)。
\item 試試看 \verb+seq(from = 0, to = 9)+ 的回傳值是什麼？
\item 用中文說明上面的程式：「在 \verb+seq()+ 這個function中，第一個引數名為 \verb+from+，表示起始值，其值為 \verb+0+；第二個引數名為 \verb+to+，表示終點值，其值是 \verb+9+。」
\end{itemize}
\end{frame}



\begin{frame}[fragile]{函數的使用手冊}
\begin{itemize}
\item 觀看某個函數的使用手冊：\verb+?函數名+ 或 \verb+help(函數名)+。
\item 請看看 \verb+?seq+。
\item 使用手冊中都有以下資訊：
\begin{description}[longest item]
	\item [Description] 函數的功能。
	\item [Usage] 基本語法，包括了引數的順序和預設值。
	\item [Arguments] 引數的細節。
	\item [Details] 函數的詳細內容。
	\item [Value] 回傳值的內容。
	\item [See Also] 其它相關的函數。
	\item [Examples] 使用範例。
\end{description}
\end{itemize}
\end{frame}



\begin{frame}[fragile]{引數的預設值}

\begin{block}{\texttt{seq()} 的使用語法}
\verb+seq(from = 1, to = 1, ...)+ \\
\end{block}
\begin{itemize}
\item 在使用手冊中可以看出：
  \\ 第一個引數 \verb+from+ 的預設值是 1。
  \\ 第一個引數 \verb+to+ 的預設值是 1。
\item 使用者未定義時採用的值，就是預設值。
\item 方便快速使用。
\item 例如：\\
  \verb+seq(from = 10)+ 和 \\
  \verb+seq(from = 10, to = 1)+ 是相等的。
\end{itemize}
\end{frame}


\begin{frame}[fragile]{引數的順序}

\begin{block}{\texttt{seq()}的使用語法}
\verb+seq(from = 1, to = 1, ...)+ \\
\end{block}

\begin{itemize}
\item 當明確指定引數名時，引數的順序無所謂。例如：\\ \verb+seq(from = 0, to = 9)+ 和 \\ \verb+seq(to = 9, from = 0)+ 同義。
\item 當引數的順序與該函數要求的順序相同時，可以省略引數名。例如：\\ \verb+seq(from = 0, to = 9)+ 可以省略為 \\ \verb+seq(0, 9)+ 的形式。
\end{itemize}
\end{frame}


\begin{frame}[fragile]{引數的綜合練習}

\begin{block}{\texttt{seq()}的使用語法}
\verb+seq(from = 1, to = 1, ...)+ \\
\end{block}

試回答下列程式的回傳值為何？
\begin{itemize}
\item \verb+seq(from = 3, to = 1)+
\item \verb+seq(3, to = 1)+
\item \verb+seq(from = 3, 1)+
\item \verb+seq(3, 1)+
\item \verb+seq(to = 1, from = 3)+
\end{itemize}
\end{frame}



\begin{frame}[fragile]{Q\&A的時間又到囉}
\begin{itemize}
\item[Q] 成千上萬的函數哪學得完？
\item[A] 不用學完！沒人學得完！學常用的就好。
\end{itemize}
\begin{itemize}
\item[Q] 函數的使用手冊看不懂耶。
\item[A] 我也常看不懂。儘量看，多嘗試，特別是 Example 部份。
\end{itemize}
\begin{itemize}
\item[Q] 如何找能做某件事的函數？
\item[A] 請Google大神幫你找最快。真的。
\end{itemize}
\end{frame}


\section{資料的讀取與整理}\subsection{}

\begin{frame}[fragile]{讀取CSV資料檔案}
\begin{enumerate}
\item 前往 \url{http://goo.gl/YRCOaN}，下載 \verb+exam.xlsx+ 並開啟這個試算表。
\item 開啟 \verb+exam.xlsx+，注意第一列必需有一列「變數名」。
\item 另存新檔 $\rightarrow$ 檔名為「exam」，類型為「CSV」，儲存在C disk下的LearnR2015資料夾中。
\item \verb+getwd()+ 顯示目前R所在的路徑。
\item \verb+setwd("C:/LearnR2015")+ 到達該資料夾。
\item \verb+dt <- read.csv("exam.csv")+ 或是 \\
      \verb+dt <- read.csv("C:/LearnR2015/exam.csv")+ 以讀取該檔成為一個資料框（data frame），並取名為 \verb+dt+。\\
\item \verb+dt+ 的結果是什麼？
\end{enumerate}
\end{frame}


\begin{frame}[fragile]{提取特定變數（欄）}
\begin{verbatim}
> dt
  ID Gender Group Literature Science
1 23      m     A         36      63
...
\end{verbatim}

如何取得Science變數？直接輸入 \verb+Science+ 是不行的，因為它是在 \verb+dt+ 裡的變數。
\begin{itemize}
\item \verb+dt$Science+ 意思是「dt裡的Science變數」
\item \verb+dt[ , 5]+ 意思是「dt裡的第5欄變數」
\item \verb+attach(dt)+ 可使dt的所有變數傳至表層。
\end{itemize}
\end{frame}


\begin{frame}[fragile]{提取特定重覆數（列）}
\begin{itemize}
\item \verb+dt[3 , ]+ 取得「dt裡的第3列變數」
\item \verb+subset(dt, Gender == "m")+ \\ 取得 Gender 是 m 的資料。
\item \verb+subset(dt, Science >= 60)+ \\ 取得 Science 大於等於 60 的資料。
\item \verb+subset(dt, Gender == "m" | Science >= 60)+ \\ 取得 Gender 是 m \alert{或} Science 大於等於 60 的資料。
\item \verb+subset(dt, Gender == "m" & Science >= 60)+ \\ 取得 Gender 是 m \alert{且} Science 大於等於 60 的資料。
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Q\&A的時間又到囉}
\begin{itemize}
\item[Q] 可否直接讀取 xlsx 檔？\\
\item[A] 可以！請日後自行研究 \verb+xlsx+ 這個套件。
\end{itemize}
\begin{itemize}
\item[Q] 可不可以資料排序？\\
\item[A] 可以！請日後自行研究 \verb+order()+ 和 \verb+sort()+。
\end{itemize}
\end{frame}


\section{統計分析與繪圖}\subsection{}

\begin{frame}[fragile]{單樣本\emph{T}檢驗}

\begin{block}{目標}
檢驗Science的平均是否為60。
\end{block}
\begin{block}{\texttt{t.test}基本語法}
\verb+t.test(+
  \verb+資料, alternative = "t" 或 "l" 或 "g",+
  \verb+mu = 假說平均數)+
\end{block}
\begin{verbatim}
t.test(dt$Science, alternative = "t", mu = 60) #雙尾
t.test(dt$Science, alternative = "g", mu = 60) #右單尾
t.test(dt$Science, alternative = "l", mu = 60) #左單尾
\end{verbatim}
\end{frame}

\begin{frame}[fragile]{雙樣本成對\emph{T}檢驗}
\begin{block}{目標}
檢驗Literature和Science差之平均是否為0。
\end{block}
\begin{block}{\texttt{t.test()}基本語法}
\verb+t.test(+
\verb+資料一, 資料二, alternative = "t" 或 "l" 或 "g",+
\verb+mu = 假說中配對差的平均數, pair = true)+
\end{block}
\begin{verbatim}
t.test(dt$Literature, dt$Science, pair = T)
# 預設雙尾；預設平均差為零
\end{verbatim}
\end{frame}


\begin{frame}[fragile]{雙樣本獨立\emph{T}檢驗}
\begin{block}{目標}
檢驗二種Gender的Literature之平均是否相等。
\end{block}
\begin{block}{\texttt{t.test()}基本語法}
\verb+t.test(+
\verb+資料一, 資料二, alternative = "t" 或 "l" 或 "g",+
\verb+mu = 假說中平均數的差, pair = F, var.equal = T)+
\end{block}
\begin{verbatim}
t.test(
  subset(dt, Gender == "m")$Literature,
  subset(dt, Gender == "f")$Literature,
  var.equal = F)
# 預設雙尾；預設平均差為零；假設變方相等
\end{verbatim}
\end{frame}

\begin{frame}[fragile]{雙樣本獨立\emph{T}檢驗（以formula表示）}
\begin{block}{目標}
檢驗二種Gender的Literature之平均是否相等。
\end{block}
\begin{block}{\texttt{t.test()}基本語法}
\verb+t.test(+
\verb+應變數 ~ 類別因子, data = 數據框, ...)+
\end{block}
\begin{verbatim}
t.test(Literature ~ Gender, data = dt, var = F)
# 預設雙尾；預設平均差為零；假設變方相等
\end{verbatim}
\end{frame}

\begin{frame}[fragile]{盒形圖}

\begin{block}{\texttt{boxplot()}基本語法}
\verb+boxplot(應變數 ~ 類別因子, data = 資料框)+
\end{block}

\begin{verbatim}
boxplot(
  Literature ~ Gender, data = dt, 
  ylab = "Literature score", xlab = "Gender"
)
\end{verbatim}

\begin{center}
\includegraphics[width=0.4\textwidth]{Rplot-two-group.pdf}
\end{center}
\end{frame}

\begin{frame}[fragile]{單因子變異數分析}
\begin{block}{目標}
檢驗三種Group的Literature之平均是否相等，並進行Tukey事後檢驗。
\end{block}

\begin{block}{\texttt{aov()}語法}
\verb+aov(+
\verb+應變數 ~ 三組以上類別自變數, data = 數據框, ...)+
\end{block}

\begin{block}{\texttt{TukeyHSD()}語法}
\verb+TukeyHSD(aov物件, "分組因子", ...)+
\end{block}

\begin{verbatim}
fit <- aov(Literature ~ Group, data = dt)
summary(fit)
TukeyHSD(fit, "Group")
\end{verbatim}

\end{frame}

\begin{frame}[fragile]{盒形圖}

\begin{block}{\texttt{boxplot()}基本語法}
\verb+boxplot(應變數 ~ 類別因子, data = 資料框)+
\end{block}

\begin{verbatim}
boxplot(
  Literature ~ Group, data = dt, 
  ylab = "Literature score", xlab = "Group"
)
\end{verbatim}

\begin{center}
\includegraphics[width=0.7\textwidth]{Rplot-three-group.pdf}
\end{center}
\end{frame}

\begin{frame}[fragile]{簡單線性迴歸與相關}
\end{frame}


%\begin{frame}[fragile]{卡方適合度檢驗}
%\end{frame}

%\begin{frame}[fragile]{卡方獨立性檢驗}
%\end{frame}


\section{學習與討論資源}\subsection{}

\section{小試身手}\subsection{}


\end{document}